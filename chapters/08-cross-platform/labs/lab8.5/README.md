# Lab 8.5: Study Carbon & Reflection

## Objective

Study IBM Carbon Design System's cross-platform token approach and reflect on multi-platform design token strategies.

## Time Estimate

~25 minutes

## Prerequisites

- Completed Labs 8.1-8.4
- Understanding of Style Dictionary output

## Setup

### Quick Setup

```bash
./setup.sh
```

This will:
1. Display summary of all generated files
2. Show comparison table
3. Display reflection questions

### Manual Setup

No files to create - this is a research and reflection lab.

## Exercises

### Exercise 1: Explore IBM Carbon

IBM Carbon is one of the best open-source examples of cross-platform tokens:

**Repository:** https://github.com/carbon-design-system/carbon

Key directories to explore:
```
carbon/
├── packages/colors/        # Color token definitions
├── packages/themes/        # Theme configurations
├── packages/type/          # Typography tokens
└── packages/layout/        # Spacing and layout tokens
```

**Questions to investigate:**
1. How do they structure their token files?
2. What platforms do they generate for?
3. How do they handle theming across platforms?

### Exercise 2: Compare Token Structures

| Aspect | Your Implementation | IBM Carbon |
|--------|---------------------|------------|
| Token format | JSON | ? |
| Build tool | Style Dictionary | ? |
| Platforms | CSS, iOS, Android, TS | ? |
| Theme handling | ? | ? |
| Semantic tokens | ? | ? |

Fill in the "?" by exploring the Carbon repository.

### Exercise 3: Analyze Platform-Specific Needs

Each platform has unique requirements:

| Platform | Unique Needs |
|----------|--------------|
| **Web/CSS** | CSS variables, fallbacks, media queries |
| **iOS** | UIColor, CGFloat, Dark mode traits |
| **Android** | Resources system, night mode, density |
| **React Native** | JS objects, StyleSheet, platform-specific |

Consider: How would you extend your token system for each need?

### Exercise 4: Evaluate Alternatives

Other cross-platform token tools:

**Theo (Salesforce)**
- Predecessor to Style Dictionary
- YAML/JSON input
- Multiple platform output

**Diez**
- Cross-platform design system framework
- TypeScript-first
- Native component generation

**Specify**
- Design token management platform
- Figma integration
- Multiple output formats

**Questions:**
1. What are the trade-offs of each approach?
2. Why might you choose Style Dictionary over alternatives?

### Exercise 5: Written Reflection

Answer these questions thoughtfully:

1. **Why generate tokens for multiple platforms instead of copying values?**
   ```



   ```

2. **What happens if you need to change a color across all platforms?**
   ```



   ```

3. **How would you add a new platform (like Flutter)?**
   ```



   ```

4. **What's the hardest part of maintaining cross-platform tokens?**
   ```



   ```

5. **How would you handle platform-specific variations (e.g., iOS uses pt, Android uses dp)?**
   ```



   ```

## Key Concepts

### Single Source of Truth Benefits

```
Without automation:
- colors.css (web)         ┐
- Colors.swift (iOS)       │ Manual sync required
- colors.xml (Android)     │ Error-prone
- colors.js (React Native) ┘

With Style Dictionary:
- tokens/colors.json → Style Dictionary → All platforms
                       ↑
                  Change once, generate all
```

### Token Distribution Strategies

| Strategy | Pros | Cons |
|----------|------|------|
| **Copy files** | Simple | Manual, error-prone |
| **Git submodule** | Version controlled | Complex setup |
| **Package manager** | Standard workflow | Versioning overhead |
| **CI/CD generation** | Automated | Infrastructure needed |

### Extending for New Platforms

To add Flutter support:

```javascript
// In style-dictionary.config.js
const StyleDictionary = require('style-dictionary');

// Register custom format
StyleDictionary.registerFormat({
  name: 'flutter/class.dart',
  formatter: function({ dictionary }) {
    return `// Generated by Style Dictionary
import 'package:flutter/material.dart';

class AppColors {
${dictionary.allTokens
  .filter(token => token.type === 'color')
  .map(token => `  static const ${token.name} = Color(0xFF${token.value.slice(1)});`)
  .join('\n')}
}`;
  }
});

// Add to platforms
module.exports = {
  platforms: {
    flutter: {
      transformGroup: "js",
      buildPath: "build/flutter/",
      files: [{
        destination: "colors.dart",
        format: "flutter/class.dart",
        filter: { type: "color" }
      }]
    }
  }
};
```

### Dark Theme Strategy

Options for cross-platform dark themes:

1. **Separate token files:**
   ```
   tokens/colors-light.json
   tokens/colors-dark.json
   ```

2. **Theme attribute:**
   ```json
   {
     "color": {
       "bg": {
         "value": "#FFFFFF",
         "darkValue": "#111827"
       }
     }
   }
   ```

3. **Platform-specific handling:**
   - iOS: Asset catalogs with appearances
   - Android: values-night/ directory
   - Web: CSS custom properties with .dark class

## Checklist

Before completing Chapter 8:

- [ ] Explored IBM Carbon repository
- [ ] Compared approaches with your implementation
- [ ] Understood platform-specific needs
- [ ] Completed written reflection
- [ ] Can explain benefits of single source of truth
- [ ] Know how to add a new platform

## Files You Should Have

```
packages/tokens/build/
├── css/
│   └── variables.css
├── js/
│   └── tokens.js
├── ts/
│   ├── tokens.ts
│   └── tokens.d.ts
├── ios/
│   ├── Colors.swift
│   ├── Spacing.swift
│   └── Typography.swift
└── android/
    ├── colors.xml
    ├── dimens.xml
    └── font_sizes.xml
```

## Extension Exercises

### Extension 1: Add Flutter Support

Implement the Flutter format shown above and generate Dart files.

### Extension 2: Add Dark Theme

Create a dark theme variant:
1. Add dark token values
2. Generate separate output files
3. Integrate with platform dark mode

### Extension 3: Token Documentation

Generate documentation from tokens:
- Token name, value, description
- Platform usage examples
- Visual swatches

## Next Chapter

In Chapter 9, you'll learn about versioning and publishing your design system packages.
